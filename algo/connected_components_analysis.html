<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç°åº¦å›¾åƒè¿é€šåŸŸåˆ†æ - C++éé€’å½’DFSå®ç°</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #34495e;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        .section {
            margin: 30px 0;
            padding: 25px;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .code-block {
            background: #f8f9fa;
            color: #000000;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #dee2e6;
            line-height: 1.4;
        }
        
        .code-block pre {
            margin: 0;
            padding: 0;
            background: transparent;
            border: none;
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .code-block code {
            background: transparent;
            color: #000000;
            padding: 0;
            font-family: inherit;
            font-size: inherit;
        }
        
        .code-block code.cpp {
            color: #000000;
        }
        
        .code-block code.bash {
            color: #000000;
        }
        
        .highlight {
            background: #f39c12;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .demo-area {
            border: 2px dashed #3498db;
            padding: 20px;
            margin: 20px 0;
            background: #ecf0f1;
            border-radius: 10px;
            text-align: center;
        }
        
        .canvas-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        canvas {
            border: 2px solid #34495e;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            cursor: pointer;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        button {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .algorithm-step {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .warning {
            background: #ffeaa7;
            border-left: 4px solid #fdcb6e;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .stack-visualization {
            background: #f8f9fa;
            color: #000000;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            margin: 15px 0;
            border: 1px solid #dee2e6;
        }
        
        .stack-item {
            background: #e9ecef;
            color: #000000;
            padding: 5px 10px;
            margin: 3px 0;
            border-radius: 4px;
            border-left: 3px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ç°åº¦å›¾åƒè¿é€šåŸŸåˆ†æ (C++å®ç°)</h1>
        <p style="text-align: center; font-size: 1.2em; color: #666;">åŸºäºC++éé€’å½’DFSçš„4é‚»åŸŸè¿é€šæ€§æ£€æµ‹ - é«˜æ•ˆä¸”æ˜“äºç†è§£</p>
        
        <div class="section">
            <h2>ğŸ“– ä»€ä¹ˆæ˜¯è¿é€šåŸŸåˆ†æï¼Ÿ</h2>
            <p>è¿é€šåŸŸåˆ†ææ˜¯å›¾åƒå¤„ç†ä¸­çš„é‡è¦æŠ€æœ¯ï¼Œç”¨äºè¯†åˆ«å›¾åƒä¸­ç›¸äº’è¿æ¥çš„åƒç´ åŒºåŸŸã€‚åœ¨ç°åº¦å›¾åƒä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ¯”è¾ƒç›¸é‚»åƒç´ çš„ç°åº¦å€¼å·®å¼‚æ¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦å±äºåŒä¸€ä¸ªè¿é€šåŸŸã€‚</p>
            
            <div class="info-box">
                <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>
                <br>â€¢ <span class="highlight">4é‚»åŸŸ</span>ï¼šæ¯ä¸ªåƒç´ çš„ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªç›¸é‚»åƒç´ 
                <br>â€¢ <span class="highlight">è¿é€šæ€§åˆ¤æ–­</span>ï¼šç°åº¦å€¼å·®å¼‚å°äºé˜ˆå€¼(20)çš„åƒç´ è§†ä¸ºè¿é€š
                <br>â€¢ <span class="highlight">éé€’å½’DFS</span>ï¼šä½¿ç”¨std::stacké¿å…é€’å½’è°ƒç”¨æ ˆæº¢å‡º
                <br>â€¢ <span class="highlight">C++å®ç°</span>ï¼šä½¿ç”¨STLå®¹å™¨ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ€§èƒ½ä¼˜ç§€
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ”§ ç®—æ³•å®ç°åŸç†</h2>
            
            <div class="algorithm-step">
                <strong>æ­¥éª¤1ï¼šåˆå§‹åŒ–</strong>
                <br>åˆ›å»ºè®¿é—®æ ‡è®°æ•°ç»„å’Œç»“æœæ•°ç»„ï¼Œåˆå§‹åŒ–æ ˆç»“æ„
            </div>
            
            <div class="algorithm-step">
                <strong>æ­¥éª¤2ï¼šéå†æ¯ä¸ªåƒç´ </strong>
                <br>å¯¹æœªè®¿é—®çš„åƒç´ è¿›è¡Œè¿é€šåŸŸæ£€æµ‹
            </div>
            
            <div class="algorithm-step">
                <strong>æ­¥éª¤3ï¼šéé€’å½’DFS</strong>
                <br>ä½¿ç”¨æ ˆå­˜å‚¨å¾…è®¿é—®çš„åƒç´ åæ ‡ï¼Œé¿å…é€’å½’è°ƒç”¨
            </div>
            
            <div class="algorithm-step">
                <strong>æ­¥éª¤4ï¼š4é‚»åŸŸæ£€æŸ¥</strong>
                <br>æ£€æŸ¥å½“å‰åƒç´ çš„ä¸Šä¸‹å·¦å³å››ä¸ªé‚»å±…
            </div>
            
            <div class="algorithm-step">
                <strong>æ­¥éª¤5ï¼šè¿é€šæ€§åˆ¤æ–­</strong>
                <br>æ¯”è¾ƒé‚»å±…åƒç´ ä¸å½“å‰åƒç´ çš„ç°åº¦å€¼å·®å¼‚
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ’» æ ¸å¿ƒä»£ç å®ç° (C++)</h2>
            
            <div class="code-block">
<pre><code class="cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;stack&gt;
#include &lt;cmath&gt;

struct Point {
    int row, col;
    Point(int r, int c) : row(r), col(c) {}
};

class ConnectedComponentAnalysis {
private:
    std::vector&lt;std::vector&lt;int&gt;&gt; grayImage;
    std::vector&lt;std::vector&lt;bool&gt;&gt; visited;
    std::vector&lt;std::vector&lt;int&gt;&gt; result;
    int height, width;
    int componentCount;
    int threshold;
    
    // 4é‚»åŸŸæ–¹å‘ï¼šä¸Šã€å³ã€ä¸‹ã€å·¦
    int directions[4][2] = {{-1, 0}, {0, 1}, {1, 0}, {0, -1}};
    
    // æ£€æŸ¥åæ ‡æ˜¯å¦æœ‰æ•ˆ
    bool isValid(int row, int col) {
        return row &gt;= 0 &amp;&amp; row &lt; height &amp;&amp; col &gt;= 0 &amp;&amp; col &lt; width;
    }
    
    // éé€’å½’DFSå®ç°
    void dfsNonRecursive(int startRow, int startCol) {
        std::stack&lt;Point&gt; stack;
        stack.push(Point(startRow, startCol));
        
        int currentComponent = ++componentCount;
        
        while (!stack.empty()) {
            Point current = stack.top();
            stack.pop();
            
            int row = current.row;
            int col = current.col;
            
            // å¦‚æœå·²ç»è®¿é—®è¿‡ï¼Œè·³è¿‡
            if (visited[row][col]) continue;
            
            // æ ‡è®°ä¸ºå·²è®¿é—®å¹¶è®¾ç½®è¿é€šåŸŸID
            visited[row][col] = true;
            result[row][col] = currentComponent;
            
            // æ£€æŸ¥4é‚»åŸŸ
            for (int i = 0; i &lt; 4; i++) {
                int newRow = row + directions[i][0];
                int newCol = col + directions[i][1];
                
                // è¾¹ç•Œæ£€æŸ¥å’Œè®¿é—®çŠ¶æ€æ£€æŸ¥
                if (isValid(newRow, newCol) &amp;&amp; !visited[newRow][newCol]) {
                    // ç°åº¦å€¼å·®å¼‚æ£€æŸ¥
                    int grayDiff = abs(grayImage[row][col] - grayImage[newRow][newCol]);
                    
                    if (grayDiff &lt; threshold) {
                        stack.push(Point(newRow, newCol));
                    }
                }
            }
        }
    }
    
public:
    ConnectedComponentAnalysis(const std::vector&lt;std::vector&lt;int&gt;&gt;&amp; image, int thresh = 20) 
        : grayImage(image), threshold(thresh) {
        height = image.size();
        width = image[0].size();
        componentCount = 0;
        
        // åˆå§‹åŒ–è®¿é—®æ ‡è®°æ•°ç»„å’Œç»“æœæ•°ç»„
        visited.assign(height, std::vector&lt;bool&gt;(width, false));
        result.assign(height, std::vector&lt;int&gt;(width, 0));
    }
    
    // æ‰§è¡Œè¿é€šåŸŸåˆ†æ
    void analyze() {
        componentCount = 0;
        
        // éå†æ‰€æœ‰åƒç´ 
        for (int i = 0; i &lt; height; i++) {
            for (int j = 0; j &lt; width; j++) {
                // å¯¹æœªè®¿é—®çš„åƒç´ æ‰§è¡Œè¿é€šåŸŸæ£€æµ‹
                if (!visited[i][j]) {
                    dfsNonRecursive(i, j);
                }
            }
        }
    }
    
    // è·å–ç»“æœ
    const std::vector&lt;std::vector&lt;int&gt;&gt;&amp; getResult() const {
        return result;
    }
    
    // è·å–è¿é€šåŸŸæ•°é‡
    int getComponentCount() const {
        return componentCount;
    }
    
    // æ‰“å°ç»“æœ
    void printResult() {
        std::cout &lt;&lt; "è¿é€šåŸŸåˆ†æç»“æœ:" &lt;&lt; std::endl;
        std::cout &lt;&lt; "å›¾åƒå°ºå¯¸: " &lt;&lt; height &lt;&lt; "x" &lt;&lt; width &lt;&lt; std::endl;
        std::cout &lt;&lt; "è¿é€šåŸŸæ•°é‡: " &lt;&lt; componentCount &lt;&lt; std::endl;
        std::cout &lt;&lt; "é˜ˆå€¼: " &lt;&lt; threshold &lt;&lt; std::endl;
        
        std::cout &lt;&lt; "\nè¿é€šåŸŸæ ‡è®°çŸ©é˜µ:" &lt;&lt; std::endl;
        for (int i = 0; i &lt; height; i++) {
            for (int j = 0; j &lt; width; j++) {
                std::cout &lt;&lt; result[i][j] &lt;&lt; " ";
            }
            std::cout &lt;&lt; std::endl;
        }
    }
};

// ä½¿ç”¨ç¤ºä¾‹
int main() {
    // åˆ›å»ºæµ‹è¯•å›¾åƒ (8x8)
    std::vector&lt;std::vector&lt;int&gt;&gt; testImage = {
        {50, 52, 48, 120, 125, 200, 198, 202},
        {49, 51, 47, 118, 122, 201, 199, 203},
        {53, 50, 49, 119, 121, 197, 200, 201},
        {120, 118, 122, 125, 123, 120, 118, 122},
        {125, 123, 121, 124, 126, 119, 121, 120},
        {200, 198, 202, 120, 118, 50, 52, 48},
        {199, 201, 200, 122, 121, 49, 51, 47},
        {203, 197, 199, 124, 123, 53, 50, 49}
    };
    
    // åˆ›å»ºè¿é€šåŸŸåˆ†æå¯¹è±¡
    ConnectedComponentAnalysis cca(testImage, 20);
    
    // æ‰§è¡Œåˆ†æ
    cca.analyze();
    
    // è¾“å‡ºç»“æœ
    cca.printResult();
    
    return 0;
}</code></pre>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ¯ JavaScriptæ¼”ç¤º (åŸºäºC++é€»è¾‘)</h2>
            <div class="demo-area">
                <p>ä»¥ä¸‹JavaScriptæ¼”ç¤ºå®ç°äº†ä¸ä¸Šè¿°C++ä»£ç ç›¸åŒçš„ç®—æ³•é€»è¾‘</p>
                <div class="canvas-container">
                    <div>
                        <h3>åŸå§‹ç°åº¦å›¾åƒ</h3>
                        <canvas id="originalCanvas" width="200" height="200"></canvas>
                    </div>
                    <div>
                        <h3>è¿é€šåŸŸç»“æœ</h3>
                        <canvas id="resultCanvas" width="200" height="200"></canvas>
                    </div>
                </div>
                
                <div class="controls">
                    <button onclick="generateTestImage()">ç”Ÿæˆæµ‹è¯•å›¾åƒ</button>
                    <button onclick="runAnalysis()">æ‰§è¡Œåˆ†æ</button>
                    <button onclick="showSteps()">æ˜¾ç¤ºæ­¥éª¤</button>
                    <button onclick="generateCppCode()">ç”ŸæˆC++æµ‹è¯•ä»£ç </button>
                </div>
                
                <div id="statsDisplay" style="margin-top: 20px; font-size: 16px;"></div>
                <div id="cppCodeDisplay" style="display: none; margin-top: 20px;">
                    <h3>å¯¹åº”çš„C++æµ‹è¯•ä»£ç ï¼š</h3>
                    <div class="code-block" id="cppCode"></div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>ï¿½ C++ä»£ç è¯¦ç»†è§£é‡Š</h2>
            
            <div class="algorithm-step">
                <strong>1. æ•°æ®ç»“æ„è®¾è®¡</strong>
                <div class="code-block">
<pre><code class="cpp">// Pointç»“æ„ä½“ï¼šå­˜å‚¨åƒç´ åæ ‡
struct Point {
    int row, col;
    Point(int r, int c) : row(r), col(c) {}
};

// æ ¸å¿ƒæˆå‘˜å˜é‡
std::vector&lt;std::vector&lt;int&gt;&gt; grayImage;    // åŸå§‹ç°åº¦å›¾åƒ
std::vector&lt;std::vector&lt;bool&gt;&gt; visited;     // è®¿é—®æ ‡è®°æ•°ç»„
std::vector&lt;std::vector&lt;int&gt;&gt; result;      // è¿é€šåŸŸæ ‡è®°ç»“æœ
int componentCount;                          // è¿é€šåŸŸè®¡æ•°å™¨</code></pre>
                </div>
            </div>
            
            <div class="algorithm-step">
                <strong>2. æ ¸å¿ƒç®—æ³•ï¼šéé€’å½’DFS</strong>
                <div class="code-block">
<pre><code class="cpp">void dfsNonRecursive(int startRow, int startCol) {
    std::stack&lt;Point&gt; stack;                 // ä½¿ç”¨STLæ ˆ
    stack.push(Point(startRow, startCol));   // å‹å…¥èµ·å§‹ç‚¹
    
    int currentComponent = ++componentCount; // åˆ†é…æ–°çš„è¿é€šåŸŸID
    
    while (!stack.empty()) {
        Point current = stack.top();
        stack.pop();
        
        int row = current.row;
        int col = current.col;
        
        if (visited[row][col]) continue;     // è·³è¿‡å·²è®¿é—®çš„åƒç´ 
        
        // æ ‡è®°å½“å‰åƒç´ 
        visited[row][col] = true;
        result[row][col] = currentComponent;
        
        // æ£€æŸ¥4ä¸ªé‚»åŸŸ
        for (int i = 0; i &lt; 4; i++) {
            int newRow = row + directions[i][0];
            int newCol = col + directions[i][1];
            
            // è¾¹ç•Œæ£€æŸ¥ + è®¿é—®çŠ¶æ€æ£€æŸ¥
            if (isValid(newRow, newCol) &amp;&amp; !visited[newRow][newCol]) {
                // ç°åº¦å€¼å·®å¼‚å°äºé˜ˆå€¼åˆ™è®¤ä¸ºè¿é€š
                int grayDiff = abs(grayImage[row][col] - grayImage[newRow][newCol]);
                if (grayDiff &lt; threshold) {
                    stack.push(Point(newRow, newCol));
                }
            }
        }
    }
}</code></pre>
                </div>
            </div>
            
            <div class="algorithm-step">
                <strong>3. è¿é€šæ€§åˆ¤æ–­é€»è¾‘</strong>
                <div class="code-block">
<pre><code class="cpp">// 4é‚»åŸŸæ–¹å‘å‘é‡ï¼šä¸Šã€å³ã€ä¸‹ã€å·¦
int directions[4][2] = {{-1, 0}, {0, 1}, {1, 0}, {0, -1}};

// è¾¹ç•Œæ£€æŸ¥å‡½æ•°
bool isValid(int row, int col) {
    return row &gt;= 0 &amp;&amp; row &lt; height &amp;&amp; col &gt;= 0 &amp;&amp; col &lt; width;
}

// è¿é€šæ€§åˆ¤æ–­ï¼šç°åº¦å€¼å·®å¼‚å°äºé˜ˆå€¼
int grayDiff = abs(grayImage[row][col] - grayImage[newRow][newCol]);
if (grayDiff &lt; threshold) {
    // ä¸¤ä¸ªåƒç´ è¿é€šï¼ŒåŠ å…¥æ ˆä¸­å¾…å¤„ç†
    stack.push(Point(newRow, newCol));
}</code></pre>
                </div>
            </div>
            
            <div class="warning">
                <strong>å…³é”®ä¼˜åŠ¿ï¼š</strong>
                <br>â€¢ <span class="highlight">éé€’å½’å®ç°</span>ï¼šé¿å…é€’å½’è°ƒç”¨æ ˆæº¢å‡ºï¼Œé€‚åˆå¤§å›¾åƒå¤„ç†
                <br>â€¢ <span class="highlight">å†…å­˜é«˜æ•ˆ</span>ï¼šä½¿ç”¨STLå®¹å™¨ï¼Œè‡ªåŠ¨å†…å­˜ç®¡ç†
                <br>â€¢ <span class="highlight">ä»£ç æ¸…æ™°</span>ï¼šç»“æ„åŒ–è®¾è®¡ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤
                <br>â€¢ <span class="highlight">æ‰©å±•æ€§å¥½</span>ï¼šå¯è½»æ¾ä¿®æ”¹é‚»åŸŸç±»å‹å’Œè¿é€šæ€§åˆ¤æ–­æ¡ä»¶
            </div>
        </div>
        
        <div class="section">
            <h2>ï¿½ é¡¹ç›®ç»“æ„ä¸å®Œæ•´ç¤ºä¾‹</h2>
            
            <div class="algorithm-step">
                <strong>æ–‡ä»¶ç»“æ„</strong>
                <div class="code-block">
<pre><code class="bash">connected_components_project/
â”œâ”€â”€ connected_components.cpp    # ä¸»è¦å®ç°æ–‡ä»¶
â”œâ”€â”€ connected_components.h      # å¤´æ–‡ä»¶(å¯é€‰)
â”œâ”€â”€ test_data/                  # æµ‹è¯•æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ test1.txt              # æµ‹è¯•å›¾åƒæ•°æ®
â”‚   â””â”€â”€ test2.txt              # æ›´å¤šæµ‹è¯•æ•°æ®
â”œâ”€â”€ Makefile                   # æ„å»ºæ–‡ä»¶
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜</code></pre>
                </div>
            </div>
            
            <div class="algorithm-step">
                <strong>Makefile ç¤ºä¾‹</strong>
                <div class="code-block">
<pre><code class="bash">CXX = g++
CXXFLAGS = -std=c++11 -Wall -O2
TARGET = connected_components
SOURCE = connected_components.cpp

$(TARGET): $(SOURCE)
	$(CXX) $(CXXFLAGS) -o $(TARGET) $(SOURCE)

clean:
	rm -f $(TARGET)

test: $(TARGET)
	./$(TARGET)

.PHONY: clean test</code></pre>
                </div>
            </div>
            
            <div class="algorithm-step">
                <strong>æ‰©å±•åŠŸèƒ½ç¤ºä¾‹</strong>
                <div class="code-block">
<pre><code class="cpp">// æ·»åŠ 8é‚»åŸŸæ”¯æŒ
class ConnectedComponentAnalysis8 : public ConnectedComponentAnalysis {
private:
    // 8é‚»åŸŸæ–¹å‘ï¼šä¸Šã€å³ä¸Šã€å³ã€å³ä¸‹ã€ä¸‹ã€å·¦ä¸‹ã€å·¦ã€å·¦ä¸Š
    int directions[8][2] = {
        {-1, 0}, {-1, 1}, {0, 1}, {1, 1},
        {1, 0}, {1, -1}, {0, -1}, {-1, -1}
    };
    
    // é‡å†™DFSå‡½æ•°ä»¥æ”¯æŒ8é‚»åŸŸ
    void dfsNonRecursive(int startRow, int startCol) override {
        // ä½¿ç”¨8é‚»åŸŸçš„DFSå®ç°
        // ...
    }
};

// æ·»åŠ å›¾åƒé¢„å¤„ç†åŠŸèƒ½
class ImagePreprocessor {
public:
    static std::vector&lt;std::vector&lt;int&gt;&gt; gaussianBlur(
        const std::vector&lt;std::vector&lt;int&gt;&gt;&amp; image, 
        int kernelSize = 3
    ) {
        // é«˜æ–¯æ¨¡ç³Šå®ç°
        // ...
    }
    
    static std::vector&lt;std::vector&lt;int&gt;&gt; threshold(
        const std::vector&lt;std::vector&lt;int&gt;&gt;&amp; image, 
        int thresh = 128
    ) {
        // é˜ˆå€¼åŒ–å¤„ç†
        // ...
    }
};</code></pre>
                </div>
            </div>
        </div>
            
            <div class="code-block">
<pre><code class="bash"># ç¼–è¯‘å‘½ä»¤
g++ -o connected_components connected_components.cpp -std=c++11

# è¿è¡Œç¨‹åº
./connected_components

# é¢„æœŸè¾“å‡ºç¤ºä¾‹
è¿é€šåŸŸåˆ†æç»“æœ:
å›¾åƒå°ºå¯¸: 8x8
è¿é€šåŸŸæ•°é‡: 4
é˜ˆå€¼: 20

è¿é€šåŸŸæ ‡è®°çŸ©é˜µ:
1 1 1 2 2 3 3 3 
1 1 1 2 2 3 3 3 
1 1 1 2 2 3 3 3 
2 2 2 2 2 2 2 2 
2 2 2 2 2 2 2 2 
3 3 3 2 2 4 4 4 
3 3 3 2 2 4 4 4 
3 3 3 2 2 4 4 4 </code></pre>
        <div class="section">
            <h2>ğŸš€ ç¼–è¯‘å’Œè¿è¡Œ</h2>
            
            <div class="code-block">
<pre><code class="bash"># ç¼–è¯‘å‘½ä»¤
g++ -o connected_components connected_components.cpp -std=c++11

# è¿è¡Œç¨‹åº
./connected_components

# é¢„æœŸè¾“å‡ºç¤ºä¾‹
è¿é€šåŸŸåˆ†æç»“æœ:
å›¾åƒå°ºå¯¸: 8x8
è¿é€šåŸŸæ•°é‡: 4
é˜ˆå€¼: 20

è¿é€šåŸŸæ ‡è®°çŸ©é˜µ:
1 1 1 2 2 3 3 3 
1 1 1 2 2 3 3 3 
1 1 1 2 2 3 3 3 
2 2 2 2 2 2 2 2 
2 2 2 2 2 2 2 2 
3 3 3 2 2 4 4 4 
3 3 3 2 2 4 4 4 
3 3 3 2 2 4 4 4 </code></pre>
            </div>
            
            <div class="warning">
                <strong>ç¼–è¯‘è¦æ±‚ï¼š</strong>
                <br>â€¢ <span class="highlight">C++11æˆ–æ›´é«˜ç‰ˆæœ¬</span>ï¼šä½¿ç”¨äº†ç°ä»£C++ç‰¹æ€§
                <br>â€¢ <span class="highlight">æ ‡å‡†åº“æ”¯æŒ</span>ï¼šéœ€è¦&lt;vector&gt;, &lt;stack&gt;, &lt;iostream&gt;
                <br>â€¢ <span class="highlight">ä¼˜åŒ–å»ºè®®</span>ï¼šä½¿ç”¨-O2ä¼˜åŒ–æ ‡å¿—æé«˜æ€§èƒ½
                <br>â€¢ <span class="highlight">è°ƒè¯•æ¨¡å¼</span>ï¼šä½¿ç”¨-g -Wallè¿›è¡Œè°ƒè¯•å’Œè­¦å‘Šæ£€æŸ¥
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ“Š ç®—æ³•å¤æ‚åº¦åˆ†æ</h2>
        
        <div class="section">
            <h2>âš¡ ä¼˜åŒ–æŠ€å·§</h2>
            <div class="info-box">
                <strong>1. æ ˆä¼˜åŒ–ï¼š</strong>ä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿæ ˆï¼Œé¿å…é¢‘ç¹çš„push/popæ“ä½œ
                <br><strong>2. å†…å­˜ä¼˜åŒ–ï¼š</strong>å¤ç”¨æ•°ç»„ç©ºé—´ï¼Œå‡å°‘å†…å­˜åˆ†é…
                <br><strong>3. å¹¶è¡Œå¤„ç†ï¼š</strong>å¯¹äºå¤§å›¾åƒï¼Œå¯ä»¥åˆ†å—å¹¶è¡Œå¤„ç†
                <br><strong>4. é˜ˆå€¼è°ƒæ•´ï¼š</strong>æ ¹æ®å›¾åƒç‰¹æ€§åŠ¨æ€è°ƒæ•´è¿é€šæ€§é˜ˆå€¼
            </div>
        </div>
        
        <div id="stepVisualization" style="display: none;">
            <h2>ğŸ”„ ç®—æ³•æ‰§è¡Œæ­¥éª¤</h2>
            <div class="stack-visualization">
                <div>æ ˆçŠ¶æ€å¯è§†åŒ–ï¼š</div>
                <div id="stackState"></div>
            </div>
        </div>
    </div>
    
    <script>
        let grayImage = [];
        let resultImage = [];
        
        // ç”Ÿæˆæµ‹è¯•å›¾åƒ
        function generateTestImage() {
            const canvas = document.getElementById('originalCanvas');
            const ctx = canvas.getContext('2d');
            const size = 20; // 20x20åƒç´ 
            
            grayImage = [];
            
            // ç”Ÿæˆå…·æœ‰ä¸åŒç°åº¦åŒºåŸŸçš„æµ‹è¯•å›¾åƒ
            for (let i = 0; i < size; i++) {
                grayImage[i] = [];
                for (let j = 0; j < size; j++) {
                    let grayValue;
                    if (i < 8 && j < 8) {
                        grayValue = 50 + Math.random() * 10; // æ·±ç°åŒºåŸŸ
                    } else if (i > 12 && j > 12) {
                        grayValue = 200 + Math.random() * 10; // æµ…ç°åŒºåŸŸ
                    } else {
                        grayValue = 120 + Math.random() * 15; // ä¸­ç°åŒºåŸŸ
                    }
                    grayImage[i][j] = Math.floor(grayValue);
                }
            }
            
            // ç»˜åˆ¶åŸå§‹å›¾åƒ
            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const pixelSize = canvas.width / size;
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    const gray = grayImage[i][j];
                    for (let py = 0; py < pixelSize; py++) {
                        for (let px = 0; px < pixelSize; px++) {
                            const index = ((i * pixelSize + py) * canvas.width + (j * pixelSize + px)) * 4;
                            imageData.data[index] = gray;     // R
                            imageData.data[index + 1] = gray; // G
                            imageData.data[index + 2] = gray; // B
                            imageData.data[index + 3] = 255;  // A
                        }
                    }
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
            document.getElementById('statsDisplay').innerHTML = `å›¾åƒå°ºå¯¸: ${size}Ã—${size}`;
        }
        
        // æ‰§è¡Œè¿é€šåŸŸåˆ†æ
        function runAnalysis() {
            if (grayImage.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆæµ‹è¯•å›¾åƒï¼');
                return;
            }
            
            const result = connectedComponents(grayImage, 20);
            resultImage = result.result;
            
            // ç»˜åˆ¶ç»“æœå›¾åƒ
            const canvas = document.getElementById('resultCanvas');
            const ctx = canvas.getContext('2d');
            const size = grayImage.length;
            
            // ä¸ºä¸åŒè¿é€šåŸŸç”Ÿæˆä¸åŒé¢œè‰²
            const colors = generateColors(result.componentCount);
            
            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const pixelSize = canvas.width / size;
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    const componentId = resultImage[i][j];
                    const color = colors[componentId - 1] || [0, 0, 0];
                    
                    for (let py = 0; py < pixelSize; py++) {
                        for (let px = 0; px < pixelSize; px++) {
                            const index = ((i * pixelSize + py) * canvas.width + (j * pixelSize + px)) * 4;
                            imageData.data[index] = color[0];     // R
                            imageData.data[index + 1] = color[1]; // G
                            imageData.data[index + 2] = color[2]; // B
                            imageData.data[index + 3] = 255;      // A
                        }
                    }
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
            document.getElementById('statsDisplay').innerHTML = 
                `è¿é€šåŸŸæ•°é‡: ${result.componentCount} | é˜ˆå€¼: 20`;
        }
        
        // ç”Ÿæˆé¢œè‰²
        function generateColors(count) {
            const colors = [];
            for (let i = 0; i < count; i++) {
                colors.push([
                    Math.floor(Math.random() * 256),
                    Math.floor(Math.random() * 256),
                    Math.floor(Math.random() * 256)
                ]);
            }
            return colors;
        }
        
        // ç”ŸæˆC++æµ‹è¯•ä»£ç 
        function generateCppCode() {
            if (grayImage.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆæµ‹è¯•å›¾åƒï¼');
                return;
            }
            
            const size = grayImage.length;
            let cppCode = `// å½“å‰æµ‹è¯•å›¾åƒçš„C++ä»£ç \n`;
            cppCode += `std::vector<std::vector<int>> testImage = {\n`;
            
            for (let i = 0; i < size; i++) {
                cppCode += `    {`;
                for (let j = 0; j < size; j++) {
                    cppCode += grayImage[i][j];
                    if (j < size - 1) cppCode += ', ';
                }
                cppCode += `}`;
                if (i < size - 1) cppCode += ',';
                cppCode += `\n`;
            }
            
            cppCode += `};\n\n`;
            cppCode += `// åˆ›å»ºè¿é€šåŸŸåˆ†æå¯¹è±¡å¹¶æ‰§è¡Œ\n`;
            cppCode += `ConnectedComponentAnalysis cca(testImage, 20);\n`;
            cppCode += `cca.analyze();\n`;
            cppCode += `cca.printResult();`;
            
            document.getElementById('cppCode').textContent = cppCode;
            const cppDisplay = document.getElementById('cppCodeDisplay');
            cppDisplay.style.display = cppDisplay.style.display === 'none' ? 'block' : 'none';
        }
        
        // è¿é€šåŸŸåˆ†ææ ¸å¿ƒå‡½æ•° (JavaScriptç‰ˆæœ¬ï¼Œå¯¹åº”C++é€»è¾‘)
        function connectedComponents(grayImage, threshold = 20) {
            const height = grayImage.length;
            const width = grayImage[0].length;
            const visited = Array(height).fill().map(() => Array(width).fill(false));
            const result = Array(height).fill().map(() => Array(width).fill(0));
            
            let componentId = 0;
            const directions = [[-1, 0], [0, 1], [1, 0], [0, -1]];
            
            // è¾¹ç•Œæ£€æŸ¥å‡½æ•°
            function isValid(row, col) {
                return row >= 0 && row < height && col >= 0 && col < width;
            }
            
            // éé€’å½’DFSå‡½æ•° (å¯¹åº”C++çš„dfsNonRecursive)
            function dfsNonRecursive(startRow, startCol) {
                const stack = [{row: startRow, col: startCol}];
                const currentComponent = ++componentId;
                
                while (stack.length > 0) {
                    const current = stack.pop();
                    const row = current.row;
                    const col = current.col;
                    
                    if (visited[row][col]) continue;
                    
                    visited[row][col] = true;
                    result[row][col] = currentComponent;
                    
                    // æ£€æŸ¥4é‚»åŸŸ
                    for (const [dr, dc] of directions) {
                        const newRow = row + dr;
                        const newCol = col + dc;
                        
                        if (isValid(newRow, newCol) && !visited[newRow][newCol]) {
                            const grayDiff = Math.abs(
                                grayImage[row][col] - grayImage[newRow][newCol]
                            );
                            
                            if (grayDiff < threshold) {
                                stack.push({row: newRow, col: newCol});
                            }
                        }
                    }
                }
            }
            
            // éå†æ‰€æœ‰åƒç´ 
            for (let i = 0; i < height; i++) {
                for (let j = 0; j < width; j++) {
                    if (!visited[i][j]) {
                        dfsNonRecursive(i, j);
                    }
                }
            }
            
            return { result, componentCount: componentId };
        }
        
        // æ˜¾ç¤ºç®—æ³•æ­¥éª¤
        function showSteps() {
            const stepDiv = document.getElementById('stepVisualization');
            stepDiv.style.display = stepDiv.style.display === 'none' ? 'block' : 'none';
            
            if (stepDiv.style.display === 'block') {
                document.getElementById('stackState').innerHTML = `
                    <div class="stack-item">æ­¥éª¤1: åˆå§‹åŒ–è®¿é—®æ•°ç»„å’Œç»“æœæ•°ç»„</div>
                    <div class="stack-item">æ­¥éª¤2: éå†æ¯ä¸ªåƒç´ ç‚¹</div>
                    <div class="stack-item">æ­¥éª¤3: å¯¹æœªè®¿é—®çš„åƒç´ æ‰§è¡ŒDFS</div>
                    <div class="stack-item">æ­¥éª¤4: ä½¿ç”¨æ ˆå­˜å‚¨å¾…è®¿é—®åæ ‡</div>
                    <div class="stack-item">æ­¥éª¤5: æ£€æŸ¥4é‚»åŸŸè¿é€šæ€§</div>
                    <div class="stack-item">æ­¥éª¤6: æ ‡è®°è¿é€šåŸŸID</div>
                `;
            }
        }
        
        // åˆå§‹åŒ–
        generateTestImage();
    </script>
</body>
</html>